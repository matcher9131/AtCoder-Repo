# [ABC358](https://atcoder.jp/contests/abc358) Review
- バーチャル参加
- Fが予想外に時間が掛かるがなんとか通して900位程度相当

## E - Alphabet Tiles
- 時間切れ
- $\mathrm{dp}_{i,j}$ を $i$ 番目のアルファベットまででできる長さ $j$ の文字列の個数とおけば行ける
  - シンプルに2要素DPで行けることになかなか気付けなかった
- 更新がやや特殊で、 $j$ 文字からなる文字列に $i$ 番目のアルファベットを $c$ 個追加しようとしているとき、その場合の数は $\begin{pmatrix} j + c \\ c \end{pmatrix} = \dfrac{(j + c)!}{j!c!}$ 通りであることを使う
  - 場合の数が↑になることの証明
    - 追加する $c$ 個を左から順に文字列のどこに挿入するかを決めるようにすると、これは $0$ 以上 $j'$ 以下の整数からなる長さ $c$ の広義単純増加列になるので、その個数を数えればよい
    - 広義単純増加列の個数は重複組合せで求まる
      - $j$ 個のボールと $c-1$ 個の仕切りを横一列に並べて $k$ 番目の仕切りより左にあるボールの総数を $A_k$ とすると、 $A$ は↑の条件を満たす広義単純増加列になる
- 時間計算量はアルファベットの種類数を $A$ として $O(AK \max C)$ なのだが……
  - 階乗は前計算で`perm`として求めておくとして、 $\begin{pmatrix} j + c \\ c \end{pmatrix}$ を計算するのに`perm[j + c] / perm[j] / perm[c]`としてしまい`TLE`
    - `modint`は割り算のみ $O(\log m)$ になるのでなるべく避けねばならない。勿論正しくは`perm[j + c] / (perm[j] * perm[c])`
      - なお今回はばりばり支配的だったためか、これだけで35%程度高速化した

## F - Easiest Maze
- AC(1WA)
- $K \leq N$ のとき作れないのは勿論のこと、 $N$ と $K$ の偶奇が一致しないときも不可
  - グリッドを市松模様に塗ると
    - $N$ が奇数のとき、右上と右下の色は一致するため、右上から右下の移動回数は偶数、すなわち $K$ は奇数である必要がある
    - $N$ が偶数のとき、右上と右下の色は一致しないため、右上から右下の移動回数は奇数、すなわち $K$ は偶数である必要がある
- 逆にそれ以外のときは必ず作れるはずと踏んで構築してみる
- $N$ が偶数のとき
  - 奇数段目でいくつか左へ行き、ひとつ下へ移動して偶数段目を右に戻るようにすると、この2段で $0$ マス以上 $2M -2$ マス以下の任意の偶数マスを稼ぐことができる
  - あとは2段ごとにどれだけ左へ行く必要があるのかを求めればOK
- $N$ が奇数のとき
  - $N$ が偶数のときと同じようにすると、最終段の $M-1$ マスがどうやっても通れないことに留意する
  - $MN - K >= M - 1$ のとき
    - 最終段の $M-1$ マスを通らないマスとして確定すると、残る $N-1$ 行および通る $K-1$ マスに関しては $N$ が偶数のときと全く同じように構築できる
  - $MN - K < M - 1$ のとき
    - 下から4段目を含んでそれより上は全てのマスを回れるようにしたい
      - 奇数段目で最も左のマスへ行き、ひとつ下へ移動して偶数段目を最も右のマスまで戻ればOK
    - 下図のように、下から3段目を最も左のマスまで行き、そこから左下マスへ移動してから下から1, 2段目を蛇行するように移動すればマスを稼げる
      - $M$ が奇数のとき、通らないマス`■`は必ず $M-1$ 以下の偶数個になるが、 $MN - K$ も $M-1$ 以下の偶数になることから必ず構築できる
      - $M$ が偶数のとき、通らないマス`■`は必ず $M-1$ 以下の奇数個になるが、 $MN - K$ も $M-1$ 以下の奇数になることから必ず構築できる
```
// マスのみ
N=3, M=7, K=17
↓←←←←←←
↓→↓■■■■
→↑→→→→↓

N=3, M=4, K=11
↓←←←
↓→↓■
→↑→↓
```
- 以上を思いついて実装できたが、壁を全て`+`にしてしまって1敗
  - そこぐらい楽させてくれよぉ……