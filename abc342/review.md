# [ABC342](https://atcoder.jp/contests/abc342) Review
- バーチャル参加
- Eまで解けて800位相当
- もしかして本番の夜より他の時間帯のほうがコンディションがいいのだろうか

## D - Square Pair
- AC（15分＋1WA）
- 以下のルールで数列 $B$ を作る
  - $A_i = 0$ ならば $B_i = 0$
  - そうでないならば、 $A_i$ を素因数分解して奇数乗になる素因数の積を $B_i$ とする
    - 奇数乗になる素因数が存在しなければ $B_i = 1$ とする
- $k = 0, 1, \dots, \max B$ において $B_i = k$ となる $i$ の個数を $P_k$ とすると
  - $k > 0$ においてそれぞれ $\begin{pmatrix} P_k \\ 2 \end{pmatrix}$ 通りの平方数になる組み合わせが存在する
  - $k = 0$ に関して、一方の数が $0$ ならば二数の積は $0$ すなわち平方数なので $\begin{pmatrix} N \\ 2 \end{pmatrix} - \begin{pmatrix} P_0 \\ 2 \end{pmatrix}$ 通りの平方数になる組み合わせが存在する
  - これらは排反なので和を取れば解になる
- $0$ の存在をスルーして1敗

## E - Last Train
- AC（22分）
- 駅 $N$ を根として拡張Dijkstraでなんとかなりそうと思いつく
- 駅を頂点、 $i$ 番目の電車情報を $B_i$ から $A_i$ に向かう有向辺とする有向グラフを考える
- 以下の手順で拡張Dijkstraを行う
  - $f(0) = f(1) = \dots = f(N-1) = -\infty, f(N) = \infty$ と初期化する
  - $N$ を根としてBFSを行う。ただし、
    - $f(v)$ が大きい順に探索する
    - 辺 $i$ を選んだ際の更新手順は以下の通り
      - $l_i + (k - 1)d_i \leq f(B_i) - c_i$ を満たす最大の $k \leq k_i$ 、すなわち $k = \min \left\{ k_i, 1 + \frac{f(B_i) - c_i - l_i}{d_i} \right\}$ を用いて $t = l_i + (k - 1)d_i$ とする
      - $t > f(A_i)$ ならば $f(A_i) \gets t$ と更新する
- 普段のDijkstraはコストが小さい方から探索して小さい方で更新するので全く逆になる

## F - Black Jack
- 時間切れ
- 公式解説でいうところの $q_i$ まではいけたが $r_i$ の発想が出てこなかった
  - $i = N - D + 1$ から順方向に更新しようとして、どうあがいても $O(D^2)$ 以上の計算量やんけ！と絶望していたが
    - まぁこういうときは逆方向に更新か……そっすよね……
