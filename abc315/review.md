# ABC315 Review
- Rated参加
- **遂に水色到達！**
  - 長かったぜ…

## A - tcdr
- AC
- C言語系の`switch`文なんて久々に書いたな…

## B - The Middle Day
- AC
- 丁寧に引き算をしていくだけの簡単なお仕事
  - 出力時に+1を忘れずに

## C - Flavors
- AC
- 2つのカップが同じ味のときの最大値と異なる味のときの最大値を比べる方針で
- 自分の解法：$O(N \log N)$
    1. カップを $S_i$ が大きい順に並び変える
    - 以下添え字はソート後のものを表す
    1. $F_1 \neq F_2$ ならば間違いなく満足度最大なので $S_1 + S_2$ を出力する
    1. $F_1 = F_2$ のとき、$F_1 \neq F_i$ を満たす $i$ に対して $S_1 + S_2 / 2$ と $S_1 + S_i$ の大きいほうを出力する
        - 上記を満たす $i$ が存在しないときは $S_1 + S_2 / 2$ を出力する
- ソートせずに $O(N)$ でも解けるはずだがまぁ書きやすさを優先したので…

## D - Magical Cookies
- TLEからの時間切れ
- 愚直に操作して`TLE`を喰らう
  - `WA`でなかっただけマシか…
- 行主体の管理、列主体の管理、いずれも計算量を減らせるやりかたが思いつかず
  - 文字種主体の管理は一瞬考えたものの、行or列のすべてが同じ文字かの判定が結局 $\Theta(W), \Theta(H)$ になるよなぁと考えて却下したが
    - （公式解説を見て）**$\Theta(1)$ の方法あるやんけ！**

## E - Prerequisites
- AC
- DAGおよびトポロジカルソートをすぐに思い出せたのは良かった
- $P_{i,j}$ から $i$ へ辺を張る方針で実装中に、必要のない本を除けるなら逆に辺を張ったほうが楽なことに気づくものの
  - トポロジカルソートの部分をいじるのが怖かったので、別途辺を逆に張ったグラフを用意して必要のない本を除けることにした
- 自分の解法：$O(N + \sum_{i = 1}^{N} C_i)$
    1. すべての $i$ および $1 \leq j \leq C_i$ に対し、$P_{i,j}$ から $i$ へ向かう向きの辺を張った有向グラフ $G$ を作る
    1. $G$ のすべての辺を逆にした有向グラフ $G'$ を作る
    1. $G'$ の頂点 $1$ を根とするDFSを行い、到達できなかった頂点列 $V$ を記録する
    1. $G$ の全頂点に対してトポロジカルソートを行う
    1. ↑から $V$ に含まれる頂点および頂点 $1$ を削除したものを順に出力する

## F - Shortcuts
- AC (1WA)
- チェックポイントを $1, 2, \dots , N$ の順に通るレースと聞いて思わずオリエンテーリングを想起してテンションが上がる
  - そしてチェックポイントを省略できると聞いてテンションが下がる
    - ※オリエンテーリングは1つでもチェックポイントをスルーすると即失格
- パッと見でDPでいけそうと踏む
- $dp_{i,j}$ を、「チェックポイント $1$ から $i$ までを $j$ 個を通らずに来る場合の総移動距離の最小値」と定義
- チェックポイントは何個でもスルーできるので、一見すると $dp_{i,j}$ を更新するのに $j$ 回の計算が必要となり $O(N^3)$ で`TLE`になりそうだが、以下のことに気づく
  - 1回の移動距離は最大で $10^4 \sqrt{2} \approx 14142$ なのに対し、$C \geq 15$ において通らなかったチェックポイント1個に対するペナルティは $2^{14} = 16384$ 以上になる
    - すなわち15個以上をスルーするとむしろ逆効果となるので、$j \leq 15$ として問題ない
      - これで計算量も劇的に改善できる
      - 実際にはちょっと日和って $j \lt 20$ とした
- 浮動小数点による誤差？まぁ相対誤差 $10^{-5}$ まで許されるし大丈夫やろ！（適当）
- 自分の解法：後述の $M$ を用いて $O(NM^2)$
    1. $M = \min \{ n, 20 \}$ とする
    1. 上述のDPを $dp_{i,j} = \min_{ \max \{i - 1, j - 1 \} \lt k \lt m} \{ dp_{i - k - 1, j - k} + \sqrt{(x_i - x_{i-k-1})^2 + (y_i - y_{i-k-1})^2} \}$ で更新する
    1. $\min_{0 \leq j \lt m} \{ dp_{N,j} + \lfloor 2^{j - 1} \rfloor \}$ を出力する
- ループを書き換えた際にループ終了条件を更新し忘れて1敗。気を付けよう
