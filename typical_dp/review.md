# [Typical DP Contest](https://atcoder.jp/contests/tdpc) Review

## A - コンテスト
- `dp[i][j]: i問目までで合計点がjになることが[true=ありうる, false=あり得ない]`
- 計算量は $P = \max_i p_i$ として $O(N^2P)$

## B - ゲーム
- ネガマックス法のメモにDPを使う
- ネガマックスにしたいので自分の得点ではなく $\text{（自分の得点）} - \text{（相手の得点）}$ を考えたほうがよい
- `dp[i][j]: 左の山からi個、右の山からj個が取られている状態からゲームをスタートして、双方が最善を尽くしたときの(自分の取るものの価値の合計) - (相手の取るものの価値の合計)`
- 解は $\frac{\sum_i^A a_i + \sum_j^B b_j + \mathrm{dp}_{0,0}}{2}$
- 計算量は $O(AB)$

## C - トーナメント
- `dp[i][j]: 人jが1回戦からi回戦(1-indexed)まで勝ち続ける確率`
- 遷移: $\mathrm{dp}_{i,j} = \mathrm{dp}_{i-1,j} \sum_{k \in S} p(j, k) \mathrm{dp}_{i-1, k}$
  - ただし $S$ は $j$ が $i$ 回戦で戦う可能性がある全ての人の集合、 $p(j, k)$ は $j$ が $k$ に勝つ確率で、便宜上 $\mathrm{dp}_{0,j} = 1$ とする
- DPが難しいというよりは戦う可能性がある全ての人の集合を作るほうが難しいような……
- 計算量は $O(K2^{2K})$

## D - サイコロ
- $D = 2^a 3^b 5^c$ および出目の積が $2^x 3^y 5^z$ と表せるとき、 $x \geq a, y \geq b, z \geq c$ の全てが満たされれば出目の積は $D$ の倍数と言える
  - $D = 2^a 3^b 5^c$ と表せない場合は出目の積が $D$ の倍数となることはない
- `dp[i][x][y][z]: サイコロをi回振って出目の積が 2^x・3^y・5^z となる確率`
- $x \leq 2N, y \leq N, z \leq N$ より愚直にやると $O(N^4)$ となってしまうが
  - 一度 $x \geq a$ が満たされるとそれ以降はサイコロを振っても必ず $x \geq a$ が満たされ続けることから、遷移をちょっといじれば $x \leq a$ の範囲で考えても問題ない（ $y,z$ も同様）
    - これにより $O(N (\log D)^3)$ にできる
- 遷移（~~面倒なので~~インデックスのみ）
  - $(i, x, y, z)$ から以下の6つに遷移
    - $(i+1, x, y, z)$
    - $(i+1, \min \{ x+1, a \}, y, z)$
    - $(i+1, x, \min \{ y+1, b \}, z)$
    - $(i+1, \min \{ x+2, a \}, y, z)$
    - $(i+1, x, y, \min \{ z+1, c \})$
    - $(i+1, \min \{ x+1, a \}, \min \{ y+1, b \}, z)$
  - $\min$ を入れることで先述の問題を解消している

## E - 数
- 桁DP
- `dp[i][j][k]: i桁で桁和 mod Dがjであり、[k=0: Nより確実に小さい, k=1: Nの上からi桁と一致する]ような非負整数の個数`
- 遷移:
  - $i+1$ 桁目として $N$ の $i+1$ 桁目より小さい数 $x$ を選ぶとき
    - $\mathrm{dp}_{i,j,0}$ および $\mathrm{dp}_{i,j,1}$ から $\mathrm{dp}_{i,(j+x) \bmod D,0}$ へ遷移
  - $i+1$ 桁目として $N$ の $i+1$ 桁目と等しい数 $x$ を選ぶとき
    - $\mathrm{dp}_{i,j,0}$ から $\mathrm{dp}_{i,(j+x) \bmod D,0}$ へ遷移
    - $\mathrm{dp}_{i,j,1}$ から $\mathrm{dp}_{i,(j+x) \bmod D,1}$ へ遷移
  - $i+1$ 桁目として $N$ の $i+1$ 桁目より大きい数 $x$ を選ぶとき
    - $\mathrm{dp}_{i,j,0}$ から $\mathrm{dp}_{i,(j+x) \bmod D,0}$ へ遷移
- 解は $\mathrm{dp}_{N,0,0} + \mathrm{dp}_{N,0,1} - 1$
  - DPには数 $0$ が含まれるが題意は正整数なので $1$ を引く必要がある
- 計算量は一桁の数の種類数を $M$ として $O(|N|DM)$