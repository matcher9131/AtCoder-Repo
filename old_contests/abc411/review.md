# [ABC411](https://atcoder.jp/contests/abc411)
- Rated参加
- またしてもD止まりで1600位台
  - 最近勝率悪いなぁ……
  - レートが-16で済んだのは幸いか
    - なおEが正解していても時間的にレートが下がるのは避けられなかった模様
    - 逆に言えばDを早くにクリアできれば致命的には下がらないと言えるか

## D - Conflict 2
- AC（19分＋1TLE）
- 空のグラフ $G$ とサーバーおよびPCを表す駒を用意する
  - 以下駒 $0$ はサーバー、 駒 $i$ （ $1 \leq i \leq N$ ）はPC $i$ を示すものとする
- 初期化は以下の通り
  - $G$ に空文字が書き込まれた頂点 $V_0$ を追加する
  - 駒をすべて $V_0$ に置く
- クエリを以下の操作に対応させる
  - クエリ1: 駒 $p$ を駒 $0$ がある頂点に動かす
  - クエリ2: 文字列 $s$ が書き込まれた新たな頂点を $G$ に追加し、駒 $p$ がある頂点から新たな頂点へ向かう向きに有効辺を張る
  - クエリ3: 駒 $0$ を駒 $p$ がある頂点に動かす
- こうすることで $V_0$ から駒 $0$ がある頂点までのパス上に書き込まれた文字列をそのままの順で連結したものが解になる
- 実装の際は各頂点の親を保持することでグラフの操作を楽にしたが、文字列を $S \gets T + S$ のような形で更新してしまい`TLE`
  - 一旦頂点番号のみを記録して逆順にし、 $S \gets S + T$ と更新することで事なきを得た
  - アロケーションには敏感になるべし……

## E - E [max]
- 時間切れ
- 座標圧縮したうえで $P_k$ を「すべてのサイコロの出目の最大値が $k$ になる確率」としてサイコロ $1, 2, \dots, N$ の順に $P$ を更新することを試みたが当然うまく遷移できず
- $P_k$ を「すべてのサイコロの出目の最大値が $k$ **以下**になる確率」としてみたが↑の考え方を引きずってしまいよくわからない遷移をしてしまう
- 終了後に改めて考えたら割とあっさり通って草……草……
- 具体的には以下
  - $B_{i,k}$ を「 $i$ 番目のサイコロを1回投げて出目が $k$ 以下になる確率」とすると $P_k \gets B_{i,k} P_k$ と更新できる
  - $A_{i,1}, A_{i,2}, \dots, A_{i,6}$ を降順に並べると
    - $k \geq A_{i,1}$ に対し $B_{i,k} = 1$
    - $j < 6$ のとき $A_{i,j+1} \leq k < A_{i,j}$ に対し $B_{i,k} = 1 - j/6$
    - $k < A_{i,6}$ に対し $B_{i,k} = 0$
  - よって $P_k$ はin-placeかつ範囲更新可能
    - $1$ で初期化した`lazy_segtree`に範囲乗算を実装して $i = 1, 2, \dots, N$ の順に↑を行えばOK
      - どうでもいいが範囲乗算を実装したのは何気に初めて
  - 計算量は $O(N (\log N + \log M))$ （ $M$ は`modint`の法）
