# [ABC391](https://atcoder.jp/contests/abc391) Review
- Rated参加
- 今回もEまで解けて一安心
  - しかしながら時間かかりすぎたのでレーティングはほぼ変動せず

## D - Gravity
- AC
- ~~テトリスだとしたら設置したブロックは重力で落ちないし、ぷよぷよだとしたら行単位で消えないし…~~
- 以下を定義する
  - 各列の下から $i$ 番目に存在するブロックの集合を $S_i$
  - 各列に存在するブロックの個数の最小値を $m$
- $i \leq m$ において $S_i$ が消える時刻は以下のいずれか大きい方
  - $j \in S_i$ における $Y_j$ の最大値
  - $S_{i-1}$ が消えた時刻 $+1$
- $i > m$ において $S_i$ が消えることはない
- よって $S_1$ から順に消える時刻を求めることができる
- 計算量はソート部分を除いて $O(N)$
  - ソートは最悪 $O(N \log N)$
- 各ブロックの座標を管理する配列、各ブロックがその列の下から何番目にあるかを管理する配列、 $S_i$ を管理する配列と変数がゴチャゴチャして通るかどうかが不安だった

## E - Hierarchical Majority Vote
- AC
- $A$ に $i$ 回操作して得られる列を $A^{(i)}$ と表すことにする
- $A^{(i)}_j$ を変えるのに必要な $A$ の要素の変更数の最小値を $x_{i,j}$ を求めることを考える
  - $A^{(i-1)}_{3j-2} A^{(i-1)}_{3j-1} A^{(i-1)}_{3j}$ が $000$ または $111$ の場合
    - 2箇所変える必要があるので、 $x_{i,j}$ は $x_{i-1, 3j-2}, x_{i-1, 3j-1}, x_{i-1, 3j}$ のうち小さい方2つの和になる
  - $A^{(i-1)}_{3j-2} A^{(i-1)}_{3j-1} A^{(i-1)}_{3j}$ が $110, 101, 011$ の場合
    - $1$ のいずれかを変えればよいので、 $x_{i,j}$ は該当する $x_{i-1,*}$ のうち小さい方になる
  - $A^{(i-1)}_{3j-2} A^{(i-1)}_{3j-1} A^{(i-1)}_{3j}$ が $001, 010, 100$ の場合
    - $0$ のいずれかを変えればよいので、 $x_{i,j}$ は該当する $x_{i-1,*}$ のうち小さい方になる
  - ここの条件分岐および $x_{i,j}$ の計算のコードが汚すぎて泣ける…
    - コンテスト後に見てもどう書けばきれいに見えるのかがさっぱりわからない
- 解は $x_{N,1}$ であり、これは $i$ の小さい方から順に計算することで求まる
- 計算量は $O(3^{N+1})$
