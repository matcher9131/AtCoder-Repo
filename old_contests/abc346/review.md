# [ABC346](https://atcoder.jp/contests/abc346) Review
- バーチャル参加
- 滑り込みでFまで解けて480位相当

## D - Gomamayo Sequence
- AC（20分）
- DPっぽいがどうやっても $O(N^2)$ になるしなぁ……としばし悩む
- しばらくして良い文字列としてあり得るのが高々 $2N$ 通りしかないことに気づいて決め打ちを決行する
  - ゴールの形がある程度決まっていてそこから逆算するパターンのやつ（割と苦手……）
- すなわち以下をそれぞれ $O(N)$ で求めて
  - 左端から $i$ 文字を`0101 ...`にするのに必要なコストの合計 $l_0(i)$
  - 左端から $i$ 文字を`1010 ...`にするのに必要なコストの合計 $l_1(i)$
  - 右端から $i$ 文字を`... 1010`にするのに必要なコストの合計 $r_0(i)$
  - 右端から $i$ 文字を`... 0101`にするのに必要なコストの合計 $r_1(i)$
- $N$ が偶数なら $l_0(i) + r_0(N-i)$ および $l_1(i) + r_1(N-i)$ 、奇数なら $l_0(i) + r_1(N-i)$ および $l_1(i) + r_0(N-i)$ の最小値を求めれば良い

## E - Paint
- AC（18分）
- 行を塗る際、それまでに塗られた列の数だけ上書きされるマスが生じるため、その部分の色の更新がネックになる
  - 勿論列も同様
- ところで、塗る順序を逆にする代わりに色 $0$ 以外で塗られているマスには塗らないようにしても、最終結果は同じになる
  - これだと色の更新は起きないため、何マスを塗ればよいかだけ判断できればOK
    - すなわちどの行/列が塗られているかではなく、何行/何列が塗られているかさえ分かればよいのでクエリ毎 $O(1)$ で計算できるようになる

## F - SSttrriinngg in StringString
- AC（47分）
- 関数 $h(i, c, k)$ を $S$ の $i$ 文字目から見て $k$ 番目の文字 $c$ が $S$ の何文字目にあるかを返す関数とし、 数列 $A_i = h(A_{i-1} + 1, T_i, k)$ を定める（ただし $A_0 = 0$ とする）
  - このとき、 $g(T,k)$ が $f(S,N)$ の（連続とは限らない）部分列であるかどうかは、 $A_{|T|} \leq N|S|$ と同値であり、 $A_{|T|}$ は $k$ に対して単調に増加する
    - よって $k$ の最大値は二分探索で求まる
- あとはいかに関数 $h(i, c, k)$ を実装するかを考える
  - $i-1$ が $|S|$ で割り切れるとき
    - このとき $i$ 文字目は $S$ の先頭であるから、 $h(i, c, k) = h(1, c, k) + i - 1$
  - $i-1$ が $|S|$ で割り切れないとき、 $S$ の途中からカウントすることになり面倒なので、逆に $k$ を増やして↑と合流させたい
    - よって $i-1$ を $|S|$ で割った商および余りをそれぞれ $q, r$ 、$|S|$ の1文字目から $r$ 文字目までに含まれる文字 $c$ の個数を $k'$ とおくと、
      - $h(i, c, k) = h(q|S| + 1, c, k + k') = h(1, c, k + k') + q|S|$
  - いずれにせよ後は文字 $c$ が $S$ の何文字目に出現するかをあらかじめ調べておけば計算できる
  - 計算量は $O(|T| \log |S| \log (N|S| / |T|))$
