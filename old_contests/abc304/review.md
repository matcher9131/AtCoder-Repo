# [ABC304](https://atcoder.jp/contests/abc304) Review
- バーチャル参加
- 90分弱までFまで解けて500位台前半
  - ようやくこの感覚を取り戻した

## D - A Piece of Cake
- AC（12分）
- 左から $i$ 列目で下から $j$ 行目のピースをピース $(i,j)$ と呼ぶことにすると
  - どのイチゴがどのピース上に存在するかは二分探索により全体で $O(N (\log W + \log H))$ で求まる
- ピースは $(A+1)(B+1)$ 個存在するが、イチゴが乗ったピースは高々 $N$ 個しかないことから
  - ピース $(i,j)$ 上に存在するイチゴの個数を`map<pair<int, int>, int>`で管理することにより、イチゴの乗ったピースにおけるイチゴの最大値・最小値を $O(N \log N)$ で求めることができる
- ↑の`map`でイチゴの乗ったピースの数を $O(1)$ で取得でき、この値が $(A+1)(B+1)$ より小さい場合はイチゴの乗っていないピースが存在するので最小値を $0$ に更新すればOK

## E - Good Graph
- AC（32分＋α）
- 「$x_i$ と $y_i$ を結ぶパスが存在しない」ことは「$x_i, y_i$ をそれぞれ含む連結成分に含まれる任意の頂点が連結でない」と言い換えられるので
  - Union-find treeを構築し、 $x_i, y_i$ をその頂点のリーダーに置き換えても問題ない
    - これを`set`で管理しておいて、後は $p_i, q_i$ も同様にリーダーに置き換えて`set`を検索するのみ
- 計算量は $O((M + K + Q) \alpha(N) + (K + Q) \log K)$

## F - Shift Table
- AC（33分－α）
- $M$ に対しそのパターン数を $A_M$ とおく
- とりあえず $M$ を固定すると
  - $i = 1, 2, \dots, M$ に対し
    - $k = 0, 1, \dots, N/M-1$ のいずれかに対して $S_{kM+i}$ が`.`ならば $i$ 日目は出勤する必要がある
    - そうでないならば出勤してもしなくてもよい
  - 出勤しなくてもよい日数を $d$ とおくと $A_M = 2^d$ となる
- しかし問題文にあるとおり、異なる $M$ に対して同じシフトパターンが存在するので重複を無くす必要がある
  - ある $M$ に対し、$M' < M$ で同じパターンになりうるのは $M'$ が $M$ の約数のときに限られる
    - 逆に $M'$ が $M$ の約数のとき、任意の $M'$ のシフトパターンを複数回並べると必ず $M$ のシフトパターンで一致するものが存在する
  - よって $M$ の小さい順に $A_M$ を計算し、 $M$ の自身を除く正の約数 $m$ に対して $f(M) \gets f(M) - \sum_m f(m)$ とすればOK
- 計算量は $N$ の約数の個数を $c(N)$ として $O(c(N)(N + c(N)))$
  - $N \leq 10^5$ より $c(N)$ は高々 $128$ なので十分間に合う
