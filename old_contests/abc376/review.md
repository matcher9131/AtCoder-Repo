# [ABC376](https://atcoder.jp/contests/abc376) Review
- バーチャル参加
- Eって本当に緑色か…？信じられん…

## C - Prepare Another Box
- AC
- 全てのおもちゃを箱に入れられるかどうかは、おもちゃと箱のそれぞれを大きさの昇順でソートしておけば $N$ 回の比較で確認できる
- 買う箱の大きさ $x$ は二分探索でOK
  - この際↑のチェックは毎度ソートする必要はなく、箱に関しては大きさ $x$ の箱を挿入→チェック→大きさ $x$ の箱を（1つ）削除でOK
- メモ：`set`のイテレータのインクリメントは最悪計算量 $O(\log N)$ なので全走査は最悪 $O(N \log N)$ だが、実際はならしで $O(N)$ になるっぽい？

## D - Prepare Another Box
- AC
1. あらかじめ頂点 $1$ へ向かう辺の始点を記録しておき
1. Dijkstraで頂点 $1$ から各頂点への最短距離を求め
1. 1.で記録した頂点を見るだけ

## F - Hands on Ring (Hard)
- 時間切れ（終了後に解説を見ずに提出）
- やることはわかりやすいが細かな条件やミスをどういなすか
- 以降各クエリにおいて $H_i$ で指示される方の手をメインハンド、そうでない方をサブハンドと呼ぶことにする
- 各クエリにおいて、メインハンドは右へ動かすか左へ動かすかの2択しかない
  - ただし貪欲に（サブハンドの移動含め）最小回数となるものを取ると次のクエリ開始時の状態が悪くなり、結果最小でなくなる可能性がある
  - 一方で全探索は局面数が $2^Q$ となるため $Q \leq 3000$ より不可
  - 各クエリ終了時にメインハンドの位置は必ず $T_i$ にあり、サブハンドは残るパーツのいずれかにあるので手の配置は高々 $N$ 通り
    - よって $\mathrm{dp}_{i,j}:$ $i$ 番目のクエリが終了したときにサブハンドがパーツ $j$ にあるような累計の移動回数の最小値として2要素DPを検討する
- 一見するとクエリ開始時の手の配置が $N$ 通り、クエリ終了時の手の配置が $N$ 通り、クエリ $Q$ 個で $O(N^2Q)$ になりそうな気がするが
  - サブハンドを無駄に動かしても結局次の移動を先取りしているだけか余計に動かしているだけの2択となるため、クエリ終了時のサブハンドは元の位置にいるか、メインハンドを動かすために邪魔にならない最低限の移動をするかの2択にしかならない
  - よって計算量は $O(NQ)$ でいける
- 以降、 $T_i$ は0-indexedとする
- メインハンドを右方向に動かすときにサブハンドが邪魔になるかどうかを考える
  - クエリ開始時にメインハンド、サブハンドが握っているパーツを順に $m_i, s_i$ とすると、メインハンドから右方向にみて移動先よりも先にサブハンドが現れる条件は $(T_i - m_i) \bmod{N} \geq (s_i - m_i) \bmod{N}$
    - このときサブハンドはメインハンドの右隣まで行く必要があるので、操作回数は $(T_i - m_i) \bmod{N} + (T_i + 1 - s_i) \bmod{N}$
  - ↑を満たさないときはサブハンドは動かす必要がなく、操作回数は $(T_i - m_i) \bmod{N}$
- メインハンドを左方向に動かすときは↑の減算を逆にすれば同様の議論ができる
- `x % N`が数学的に $x \bmod{N}$ と同義にならないことに注意