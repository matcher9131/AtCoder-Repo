# [ABC294](https://atcoder.jp/contests/abc294) Review
- バーチャル参加
- 56分でFを除くGまでを解いて320位台相当
- 最近（ABC421時点）のとは異なりトンチが少ないので随分やりやすいっすね……
  - 例えばGは方針はわかりやすく、あとはそれを実現する手段を持っているかどうかで解けるかどうかが分かれる問題と言えそう
    - すなわちこのタイプの問題は過去問を解けば解くほど解けるようになる
      - 一方でトンチは……対策が難しいことこの上ない

## D - Bank
- AC（4分）
- まだ呼ばれていない人の集合 $S$ 、呼ばれたが受付に行っていない人の集合 $T$ をそれぞれ管理するだけ。以上！

## E - 2xN Grid
- AC（11分）
- 2つのランレングス符号をデコードしながら一致する箇所を探す……これ[ABC421D](https://atcoder.jp/contests/abc421/tasks/abc421_d)の簡易版じゃねぇか！
  - というわけでコードを流用したがバグがあったらしくデバッグに少々時間がかかった
- 詳細は`notes`ディレクトリのほうで

## F - Sugar Water 2
- 時間切れ
- $X$ を二分探索で求める方針でいけるところまでは分かったが、二分探索の終了条件が思いつかず時間切れ
  - 普段は整数相手に回すので`abs(ok - ng) <= 1`が終了条件だが、そうではないので混乱してしまった
    - 普通に適当な回数で打ち切ればいいだけの話だった。`atcoder-difficulty`を作ったときに何を学んでいたんすかねぇ……
- 面倒なので $B_i$ には $A_i$ を、 $D_j$ には $C_j$ を加えておいて水ではなく水溶液全体の質量としておく
- 「 $K$ 番目に濃い砂糖水の濃度が $X$ 」 $\Leftrightarrow$ 「濃度が $x$ 以上になる $(i, j)$ の組が $K$ 個以上、となる最小の $x$ が $X$ に等しい」と読み替えて二分探索
  - 濃度 $x$ に対し↑の条件を満たすかどうかは以下で判定
    1. 列 $Q$ を $Q_j = C_j - xD_j$ とし、ソートしておく
    1. 各 $i$ に対し、 $P_i = A_i - xB_i$ とする。 $Q_j \geq -P_i$ となる $j$ の個数を足し上げる
    1. ↑の結果が $K$ 以上であればOK
  - 要するに濃度 $x$ にするのに余分な/不足する砂糖の量を調べる

## G - Distance Queries on a Tree
- AC（34分）
- 木の構造が変わらないため、オイラーツアーによるタイムスタンプ + Lazy segment treeの組み合わせで辺の重みの変更を高速に処理できる。詳細は以下
- 前処理として根を適当に取ってオイラーツアーを行い、各頂点の行きがけ順と帰りがけ順のタイムスタンプ $A_i, B_i$ を記録する
  - ついでに根から各頂点までの距離を記録するが、この際長さ $2N$ の配列 $D$ を用意し、根から頂点 $i$ までの距離を $D_{A_i}$ に持たせる
    - $D$ は後述の処理で範囲更新が必要になるのでLazy segment treeにしておく
- クエリの処理
  - タイプ1:
    - 辺 $i$ の両端のうち根にから遠い方を $v$ として
      1. $D[A_v, B_j)$ に $w-w_i$ を加算
      2. $w_i \gets w$
  - タイプ2:
    - $u, v$ のLCAを $x$ として $D_{A_u} + D_{A_v} - 2D_{A_x}$ を解として出力
- 事前にダブリングでLCAを1回あたり $O(\log N)$ で求まるようにしておくことで、全体の計算量を $O(N + Q\log N)$ にできる
